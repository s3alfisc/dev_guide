<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 Continuous Integration Best Practices | rOpenSci Packages: Development, Maintenance, and Peer Review</title>
<meta name="author" content="rOpenSci software review editorial team (current and alumni): Brooke Anderson, Scott Chamberlain, Laura DeCicco, Julia Gustavsen, Jeff Hollister, Anna Krystalli, Mauro Lepore, Lincoln Mullen, Mark Padgham, Karthik Ram, Emily Riederer, Noam Ross, Maëlle Salmon, Adam Sparks, Melina Vidoni">
<meta name="description" content="This chapter summarizes our guidelines about continuous integration after explaining what continuous integration is.  Along with last chapter, it forms our guidelines for Software Peer Review.  ...">
<meta name="generator" content="bookdown 0.27.3 with bs4_book()">
<meta property="og:title" content="Chapter 2 Continuous Integration Best Practices | rOpenSci Packages: Development, Maintenance, and Peer Review">
<meta property="og:type" content="book">
<meta property="og:url" content="https://devguide.ropensci.org/ci.html">
<meta property="og:image" content="https://devguide.ropensci.org//images/cover.png">
<meta property="og:description" content="This chapter summarizes our guidelines about continuous integration after explaining what continuous integration is.  Along with last chapter, it forms our guidelines for Software Peer Review.  ...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 Continuous Integration Best Practices | rOpenSci Packages: Development, Maintenance, and Peer Review">
<meta name="twitter:site" content="@ropensci">
<meta name="twitter:description" content="This chapter summarizes our guidelines about continuous integration after explaining what continuous integration is.  Along with last chapter, it forms our guidelines for Software Peer Review.  ...">
<meta name="twitter:image" content="https://devguide.ropensci.org//images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><div class="inline-figure"><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></div></noscript>
<!-- End Matomo Code --><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">rOpenSci Packages: Development, Maintenance, and Peer Review</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li class="book-part">Building Your Package</li>
<li><a class="" href="building.html"><span class="header-section-number">1</span> Packaging Guide</a></li>
<li><a class="active" href="ci.html"><span class="header-section-number">2</span> Continuous Integration Best Practices</a></li>
<li><a class="" href="package-development-security-best-practices.html"><span class="header-section-number">3</span> Package Development Security Best Practices</a></li>
<li class="book-part">Software Peer Review of Packages</li>
<li><a class="" href="softwarereviewintro.html"><span class="header-section-number">4</span> Software Peer Review, Why? What?</a></li>
<li><a class="" href="policies.html"><span class="header-section-number">5</span> Software Peer Review policies</a></li>
<li><a class="" href="authors-guide.html"><span class="header-section-number">6</span> Guide for Authors</a></li>
<li><a class="" href="reviewerguide.html"><span class="header-section-number">7</span> Guide for Reviewers</a></li>
<li><a class="" href="editorguide.html"><span class="header-section-number">8</span> Guide for Editors</a></li>
<li><a class="" href="editorialmanagement.html"><span class="header-section-number">9</span> Editorial management</a></li>
<li class="book-part">Maintaining Packages</li>
<li><a class="" href="collaboration.html"><span class="header-section-number">10</span> Collaboration Guide</a></li>
<li><a class="" href="changing-maintainers.html"><span class="header-section-number">11</span> Changing package maintainers</a></li>
<li><a class="" href="releasing.html"><span class="header-section-number">12</span> Releasing a package</a></li>
<li><a class="" href="marketing.html"><span class="header-section-number">13</span> Marketing your package</a></li>
<li><a class="" href="grooming.html"><span class="header-section-number">14</span> GitHub Grooming</a></li>
<li><a class="" href="evolution.html"><span class="header-section-number">15</span> Package evolution - changing stuff in your package</a></li>
<li><a class="" href="curationpolicy.html"><span class="header-section-number">16</span> Package Curation Policy</a></li>
<li><a class="" href="contributingguide.html"><span class="header-section-number">17</span> Contributing Guide</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="booknews.html"><span class="header-section-number">A</span> NEWS</a></li>
<li><a class="" href="reviewtemplate.html"><span class="header-section-number">B</span> Review template</a></li>
<li><a class="" href="reviewtemplatees.html"><span class="header-section-number">C</span> Review template in Spanish</a></li>
<li><a class="" href="editortemplate.html"><span class="header-section-number">D</span> Editor’s template</a></li>
<li><a class="" href="reviewrequesttemplate.html"><span class="header-section-number">E</span> Review request template</a></li>
<li><a class="" href="approval2template.html"><span class="header-section-number">F</span> Reviewer approval comment template</a></li>
<li><a class="" href="newstemplate.html"><span class="header-section-number">G</span> NEWS template</a></li>
<li><a class="" href="bookreleaseissue.html"><span class="header-section-number">H</span> Book release guidance</a></li>
<li><a class="" href="redirect.html"><span class="header-section-number">I</span> How to set a redirect</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/ropensci/dev_guide">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="ci" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Continuous Integration Best Practices<a class="anchor" aria-label="anchor" href="#ci"><i class="fas fa-link"></i></a>
</h1>
<div class="summaryblock">
<p>
This chapter summarizes our guidelines about continuous integration after explaining what continuous integration is.
</p>
<p>
Along with <a href="building.html#building">last chapter</a>, it forms our guidelines for Software Peer Review.
</p>
</div>
<div id="why-use-continuous-integration-ci" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Why use continuous integration (CI)?<a class="anchor" aria-label="anchor" href="#why-use-continuous-integration-ci"><i class="fas fa-link"></i></a>
</h2>
<p>All rOpenSci packages must use one form of continuous integration. This ensures that all commits, pull requests and new branches are run through <code>R CMD check</code>. rOpenSci packages’ continuous integration must also be linked to a code coverage service, indicating how many lines are covered by unit tests.</p>
<p>Both test status and code coverage should be reported via badges in your package README.</p>
<p>R packages should have CI for all operating systems (Linux, Mac OSX, Windows) when they contain:</p>
<ul>
<li><p>Compiled code</p></li>
<li><p>Java dependencies</p></li>
<li><p>Dependencies on other languages</p></li>
<li><p>Packages with system calls</p></li>
<li><p>Text munging such as getting people’s names (in order to find encoding issues).</p></li>
<li><p>Anything with file system / path calls</p></li>
</ul>
<p>In case of any doubt regarding the applicability of these criteria to your package, it’s better to add CI for all operating systems. Most CI services standards setups for R packages allow this with not much hassle.</p>
</div>
<div id="whichci" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Which continuous integration service(s)?<a class="anchor" aria-label="anchor" href="#whichci"><i class="fas fa-link"></i></a>
</h2>
<p>There are a number of continuous integration services, including standalone services (CircleCI, AppVeyor), and others integrated into code hosting or related services (GitHub Actions, GitLab, AWS Code Pipeline). Different services support different operating system configurations.</p>
<p><a href="https://github.com/features/actions">GitHub Actions</a> is a convenient option for many R developers who already use GitHub as it is integrated into the platform and supports all needed operating Systems. There are <a href="https://github.com/r-lib/actions/">actions supported for the R ecosystem</a>, as well and first-class support in the <a href="https://usethis.r-lib.org/reference/github_actions.html">{usethis}</a> package. All packages submitted to rOpenSci for peer review are checked by our own <a href="https://docs.ropensci.org/pkgcheck"><code>pkgcheck</code> system</a>, described further in the <a href="authors-guide.html#authors-guide">Guide for Authors</a>. These checks are also provided as a GitHub Action in the <a href="https://github.com/ropensci-review-tools/pkgcheck-action"><code>ropensci-review-tools/pkgcheck-action</code> repository</a>. Packages authors are encouraged to use that action to confirm prior to submission that a package passes all of our checks. See <a href="https://ropensci.org/blog/2022/02/01/pkgcheck-action/">our blog post</a> for more information.</p>
<p><a href="https://usethis.r-lib.org/reference/ci.html">usethis supports CI setup for other systems</a>, though these functions are soft-deprecated. rOpenSci also supports the <a href="https://docs.ropensci.org/circle/">circle</a> package, which aids in setting up CircleCI pipelines, and the <a href="https://docs.ropensci.org/tic/">tic</a> package for building more complicated CI pipelines.</p>
<div id="testing-using-different-versions-of-r" class="section level4" number="2.2.0.1">
<h4>
<span class="header-section-number">2.2.0.1</span> Testing using different versions of R<a class="anchor" aria-label="anchor" href="#testing-using-different-versions-of-r"><i class="fas fa-link"></i></a>
</h4>
<p>We require that rOpenSci packages are tested against the latest, previous and development versions of R to ensure both backwards and forwards compatibility with base R.</p>
<p>Details of how to run tests/checks using different versions of R locally can be found in the R-hub vignette on running <a href="https://r-hub.github.io/rhub/articles/local-debugging.html">Local Linux checks with Docker</a>.</p>
<p>You can fine tune the deployment of tests with each versions by using a testing matrix.</p>
<p>If you develop a package depending on or intended for Bioconductor, you might find <a href="https://lcolladotor.github.io/biocthis/index.html">biocthis</a> relevant.</p>
</div>
<div id="minimizing-build-times-on-ci" class="section level4" number="2.2.0.2">
<h4>
<span class="header-section-number">2.2.0.2</span> Minimizing build times on CI<a class="anchor" aria-label="anchor" href="#minimizing-build-times-on-ci"><i class="fas fa-link"></i></a>
</h4>
<p>You can use these tips to minimize build time on CI:</p>
<ul>
<li>Cache installation of packages. The default <a href="https://github.com/r-lib/actions">r-lib/actions</a> do this.</li>
</ul>
</div>
<div id="travis-ci-linux-and-mac-osx" class="section level3" number="2.2.1">
<h3>
<span class="header-section-number">2.2.1</span> Travis CI (Linux and Mac OSX)<a class="anchor" aria-label="anchor" href="#travis-ci-linux-and-mac-osx"><i class="fas fa-link"></i></a>
</h3>
<p>We recommend <a href="https://ropensci.org/technotes/2020/11/19/moving-away-travis/">moving away from Travis</a>.</p>
</div>
<div id="appveyor-ci-windows" class="section level3" number="2.2.2">
<h3>
<span class="header-section-number">2.2.2</span> AppVeyor CI (Windows)<a class="anchor" aria-label="anchor" href="#appveyor-ci-windows"><i class="fas fa-link"></i></a>
</h3>
<p>For continuous integration on Windows, see <a href="https://github.com/krlmlr/r-appveyor">R + AppVeyor</a>. Set it up using <code><a href="https://usethis.r-lib.org/reference/ci.html">usethis::use_appveyor()</a></code>.</p>
<p>Here are tips to minimize AppVeyor build time:</p>
<ul>
<li><p>Cache installation of packages. <a href="https://github.com/r-lib/usethis/blob/2c52c06373849d52f78a26c5a0e080f518a2f825/inst/templates/appveyor.yml#L13">Example in a config file</a>. It’ll already be in the config file if you set AppVeyor CI up using <code><a href="https://usethis.r-lib.org/reference/ci.html">usethis::use_appveyor()</a></code>.</p></li>
<li><p>Enable <a href="https://www.appveyor.com/docs/build-configuration/#rolling-builds">rolling builds</a>.</p></li>
</ul>
<p>We no longer transfer AppVeyor projects to ropensci AppVeyor account so after transfer of your repo to rOpenSci’s “ropensci” GitHub organization the badge will be <code>[![AppVeyor Build Status](https://ci.appveyor.com/api/projects/status/github/ropensci/pkgname?branch=master&amp;svg=true)](https://ci.appveyor.com/project/individualaccount/pkgname)</code>.</p>
</div>
<div id="circle-ci-linux-and-mac-osx" class="section level3" number="2.2.3">
<h3>
<span class="header-section-number">2.2.3</span> Circle CI (Linux and Mac OSX)<a class="anchor" aria-label="anchor" href="#circle-ci-linux-and-mac-osx"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://circleci.com/">Circle CI</a> is used, for example, by rOpenSci package <a href="https://github.com/ropensci/bomrang"><code>bomrang</code></a> as continuous integration service.</p>
</div>
</div>
<div id="coverage" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Test coverage<a class="anchor" aria-label="anchor" href="#coverage"><i class="fas fa-link"></i></a>
</h2>
<p>Continuous integration should also include reporting of test coverage via a testing service such as <a href="https://codecov.io/">Codecov</a> or <a href="https://coveralls.io/">Coveralls</a>. See the <a href="https://github.com/r-lib/covr">README for the <strong>covr</strong> package</a> for instructions, as well
as <code><a href="https://usethis.r-lib.org/reference/use_coverage.html">usethis::use_coverage()</a></code>.</p>
<p>If you run coverage on several CI services <a href="https://docs.codecov.io/docs/merging-reports">the results will be merged</a>.</p>
</div>
<div id="even-more-ci-opencpu" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> Even more CI: OpenCPU<a class="anchor" aria-label="anchor" href="#even-more-ci-opencpu"><i class="fas fa-link"></i></a>
</h2>
<p>After transfer to rOpenSci’s “ropensci” GitHub organization, each push to the repo will be built on OpenCPU and the person committing will receive a notification email. This is an additional CI service for package authors that allows for R functions in packages to be called remotely via <a href="https://ropensci.ocpu.io/" class="uri">https://ropensci.ocpu.io/</a> using the <a href="https://www.opencpu.org/api.html#api-json">opencpu API</a>. For more details about this service, consult the OpenCPU <a href="https://www.opencpu.org/help.html">help page</a> that also indicates where to ask questions.</p>
</div>
<div id="rodocsci" class="section level2" number="2.5">
<h2>
<span class="header-section-number">2.5</span> Even more CI: rOpenSci docs<a class="anchor" aria-label="anchor" href="#rodocsci"><i class="fas fa-link"></i></a>
</h2>
<p>After transfer to rOpenSci’s “ropensci” GitHub organization, a pkgdown website will be built for your package after each push to the GitHub repo. You can find the status of these builds at <code>https://dev.ropensci.org/job/package_name</code>, e.g. <a href="https://dev.ropensci.org/job/magick">for <code>magick</code></a>; and the website at <code>https://docs.ropensci.org/package_name</code>, e.g. <a href="https://docs.ropensci.org/magick">for <code>magick</code></a>. The website build will use your pkgdown config file if you have one, except for the styling that will use the <a href="https://github.com/ropensci-org/rotemplate/"><code>rotemplate</code> package</a>. Please report bugs, questions and feature requests about the central builds at <a href="https://github.com/ropensci/docs/" class="uri">https://github.com/ropensci/docs/</a> and about the template at <a href="https://github.com/ropensci-org/rotemplate/" class="uri">https://github.com/ropensci-org/rotemplate/</a>.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="building.html"><span class="header-section-number">1</span> Packaging Guide</a></div>
<div class="next"><a href="package-development-security-best-practices.html"><span class="header-section-number">3</span> Package Development Security Best Practices</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#ci"><span class="header-section-number">2</span> Continuous Integration Best Practices</a></li>
<li><a class="nav-link" href="#why-use-continuous-integration-ci"><span class="header-section-number">2.1</span> Why use continuous integration (CI)?</a></li>
<li>
<a class="nav-link" href="#whichci"><span class="header-section-number">2.2</span> Which continuous integration service(s)?</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#travis-ci-linux-and-mac-osx"><span class="header-section-number">2.2.1</span> Travis CI (Linux and Mac OSX)</a></li>
<li><a class="nav-link" href="#appveyor-ci-windows"><span class="header-section-number">2.2.2</span> AppVeyor CI (Windows)</a></li>
<li><a class="nav-link" href="#circle-ci-linux-and-mac-osx"><span class="header-section-number">2.2.3</span> Circle CI (Linux and Mac OSX)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#coverage"><span class="header-section-number">2.3</span> Test coverage</a></li>
<li><a class="nav-link" href="#even-more-ci-opencpu"><span class="header-section-number">2.4</span> Even more CI: OpenCPU</a></li>
<li><a class="nav-link" href="#rodocsci"><span class="header-section-number">2.5</span> Even more CI: rOpenSci docs</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/ropensci/dev_guide/blob/master/pkg_ci.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/ropensci/dev_guide/edit/master/pkg_ci.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>rOpenSci Packages: Development, Maintenance, and Peer Review</strong>" was written by rOpenSci software review editorial team (current and alumni): Brooke Anderson, Scott Chamberlain, Laura DeCicco, Julia Gustavsen, Jeff Hollister, Anna Krystalli, Mauro Lepore, Lincoln Mullen, Mark Padgham, Karthik Ram, Emily Riederer, Noam Ross, Maëlle Salmon, Adam Sparks, Melina Vidoni. It was last built on 2022-07-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
